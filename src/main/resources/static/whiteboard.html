<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Whiteboard | Inkspire</title>
    <link rel="stylesheet" href="whiteboard.css">
    <link rel="icon" type="image/x-icon" href="icon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
</head>
<body>
<div class="app-container">
    <!-- ─── SIDEBAR ─── -->
    <div class="left-col">

        <!-- blue header / user-list / buttons -->
        <aside class="sidebar">
            <img src="icons/inkspire.svg" class="sidebar__logo" alt="Inkspire logo">

            <h1 class="sidebar__title" id="sessionName">Inkspire Whiteboard</h1>
            <hr class="sidebar__divider">

            <section class="users">
                <h2 class="sidebar__users-heading">Connected Users</h2>
                <ul class="sidebar__user-list" id="userList"></ul>
            </section>

            <section class="sidebar__footer">
                <button id="clearBtn" class="sidebar__action" onclick="clearCanvas()">Clear</button>
                <button id="disconnectBtn" class="sidebar__action" onclick="leaveSessionAndReturn()">Disconnect</button>
            </section>
        </aside>

        <!-- white chat panel -->
        <aside class="chat-panel">
            <div  id="chatMessages" class="chat__messages"></div>

            <form id="chatForm" class="chat__input-row">
                <input id="chatInput" type="text" autocomplete="off"
                       placeholder="Type in chat…">
            </form>
        </aside>

        <!-- hidden helpers -->
        <input id="sessionCode" type="hidden">
        <input id="userId"      type="hidden">
    </div>

    <!-- ─── MAIN WHITEBOARD ─── -->
    <main class="whiteboard" tabindex="0">
        <div id="canvas-wrapper">
            <canvas id="board"></canvas>
            <canvas id="preview"></canvas>
            <textarea id="textToolInput"></textarea>
        </div>
    </main>

    <!-- ─── TOOLBAR ─── -->
    <!-- top bar: only icons + color puck -->
    <div class = "toolbarX">
        <div class="tools-bar">
            <button class="tool-btn active brush" data-tool="brush">
                <svg width="27" height="28" viewBox="0 0 27 28" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M0.454717 26.5745C0.121405 26.116 0.106932 25.497 0.418441 25.0232C2.10628 22.4561 2.74181 20.4576 2.74181 17.5909C2.74181 14.268 3.44544 11.0748 5.76826 8.7351C6.55791 7.93973 7.61464 7.30614 8.67022 6.80353C9.74077 6.29387 10.893 5.88057 11.938 5.55727C12.9863 5.23287 13.9492 4.99236 14.6493 4.83288C14.9963 4.75389 15.2805 4.6943 15.4809 4.65399L19.736 1.3673C20.809 0.538538 22.3257 0.638842 23.2817 1.60184L25.7282 4.06601C26.7188 5.06376 26.7853 6.65953 25.8813 7.73735L22.5402 11.7209C22.5168 11.9178 22.4839 12.1752 22.4395 12.4796C22.3352 13.1979 22.1669 14.1871 21.9102 15.2684C21.4177 17.3435 20.5291 20.0844 18.9024 21.7229C16.3771 24.2665 13.406 25.169 10.4752 25.6683C9.482 25.8375 8.44839 25.9666 7.44006 26.0925C6.98965 26.1487 6.54428 26.2043 6.10982 26.2626C4.6686 26.4559 3.27207 26.6864 1.91206 27.0777C1.3696 27.2338 0.788015 27.033 0.454717 26.5745ZM21.1618 9.15776L23.8225 5.98563L21.3761 3.52146L18.0877 6.06137L21.1618 9.15776ZM15.6057 7.40034C15.496 7.42395 15.3748 7.45083 15.2439 7.48069C14.5906 7.62945 13.6962 7.85313 12.7292 8.15228C11.7589 8.45237 10.7374 8.82197 9.82193 9.25779C8.89148 9.70081 8.14965 10.1755 7.67395 10.6546C6.07713 12.263 5.43688 14.597 5.43688 17.5909C5.43688 19.9522 5.05266 21.8747 4.18466 23.8043C4.71417 23.7164 5.23826 23.6409 5.75406 23.5717C6.24289 23.5062 6.71734 23.447 7.18206 23.389C8.15849 23.2673 9.092 23.1508 10.0257 22.9917C12.7251 22.5318 15.0473 21.767 16.9967 19.8035C18.0425 18.75 18.8019 16.6901 19.2891 14.6372C19.5223 13.6546 19.6768 12.7481 19.7729 12.0867C19.796 11.9281 19.8155 11.7843 19.8319 11.6572L15.6057 7.40034Z" fill="currentColor"/>
                </svg>
            </button>
            <button class="tool-btn pen"    data-tool="pen">
                <svg width="26" height="26" viewBox="0 0 26 26" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.4866 0.753442C17.9323 0.60864 18.4084 0.590149 18.8616 0.698754L19.054 0.753442L19.1878 0.80227C19.4909 0.92354 19.731 1.09851 19.9251 1.26321C20.1354 1.44174 20.3656 1.67353 20.6019 1.90969L24.0726 5.38137C24.3088 5.61754 24.5405 5.84785 24.7191 6.05813C24.9072 6.27978 25.1095 6.56103 25.2288 6.92825C25.3943 7.43756 25.3943 7.98631 25.2288 8.49563C25.1095 8.86292 24.9072 9.14406 24.7191 9.36575C24.5404 9.57613 24.3089 9.8072 24.0726 10.0435L21.9349 12.1802L20.1468 18.44C19.9317 19.1929 19.7596 19.8521 19.387 20.3989C19.0816 20.8473 18.6836 21.2255 18.22 21.5073C17.6545 21.8513 16.9872 21.9894 16.2239 22.1656L2.0716 25.4312C1.64564 25.5294 1.19907 25.4014 0.889957 25.0923C0.580984 24.7832 0.452806 24.3366 0.551089 23.9107L3.81671 9.75832C3.99284 8.99515 4.13191 8.32769 4.47589 7.76223C4.75773 7.29908 5.13527 6.90153 5.58332 6.59622C6.13037 6.22355 6.79007 6.05068 7.54328 5.83547L13.8021 4.04641L15.9398 1.90969C16.176 1.67357 16.4063 1.4417 16.6165 1.26321C16.8382 1.07508 17.1194 0.872799 17.4866 0.753442ZM10.6624 15.9536C10.6622 15.6036 10.3786 15.3198 10.0286 15.3198C9.67864 15.3199 9.39509 15.6036 9.39484 15.9536C9.39484 16.1268 9.46388 16.2845 9.57648 16.3989C9.57762 16.4001 9.57925 16.4007 9.58039 16.4019C9.58132 16.4028 9.58239 16.4039 9.58332 16.4048C9.69782 16.518 9.85494 16.5884 10.0286 16.5884C10.3788 16.5884 10.6624 16.3037 10.6624 15.9536ZM18.2581 3.1968C18.145 3.29279 17.9986 3.43778 17.7327 3.70364L16.2601 5.17629L20.806 9.72219L22.2796 8.25051C22.5455 7.98464 22.6905 7.83819 22.7864 7.72512C22.7901 7.7208 22.792 7.71536 22.7952 7.71145C22.7923 7.70788 22.7897 7.70363 22.7864 7.69973C22.6905 7.58668 22.5454 7.44006 22.2796 7.17434L18.8089 3.70364C18.5431 3.43786 18.3966 3.29279 18.2835 3.1968C18.2789 3.19287 18.274 3.18952 18.2698 3.18606C18.266 3.18927 18.2624 3.19319 18.2581 3.1968ZM13.1986 15.9536C13.1986 17.7044 11.7793 19.1245 10.0286 19.1245C9.61975 19.1245 9.22929 19.0458 8.87043 18.9048L5.8089 21.9663L15.6536 19.6948C16.5871 19.4795 16.7685 19.4212 16.9017 19.3404C17.0562 19.2463 17.1895 19.1207 17.2913 18.9712C17.379 18.8424 17.4452 18.6637 17.7083 17.7427L19.3812 11.8843L14.097 6.60012L8.23957 8.27395C7.31841 8.53714 7.13983 8.6042 7.01105 8.69192C6.86176 8.7937 6.7358 8.92622 6.64191 9.08059C6.56094 9.2137 6.5038 9.39523 6.28839 10.3286L4.01593 20.1724L7.07746 17.1109C6.93683 16.7524 6.85871 16.362 6.85871 15.9536C6.85895 14.2031 8.27806 12.7837 10.0286 12.7837C11.7792 12.7837 13.1983 14.2031 13.1986 15.9536Z" fill="currentColor"/>
                </svg>
            </button>
            <button class="tool-btn highlighter" data-tool="highlighter">
                <svg width="29" height="26" viewBox="0 0 29 26" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M15.6807 1.03095C16.2161 0.495545 17.0841 0.495542 17.6195 1.03095C18.1549 1.56636 18.1549 2.43436 17.6195 2.96976L11.3209 9.26845C11.0708 9.52454 10.9308 9.86833 10.9308 10.2264C10.9308 10.5844 11.0708 10.9281 11.3209 11.1842L18.4358 18.2992C18.6917 18.5483 19.0348 18.6878 19.3921 18.6878C19.7501 18.6878 20.0938 18.5477 20.3499 18.2976L26.6486 11.9989C27.184 11.4635 28.0521 11.4635 28.5875 11.9989C29.1229 12.5343 29.1229 13.4024 28.5875 13.9378L22.2809 20.2444L22.2712 20.254C21.5024 21.0076 20.4687 21.4298 19.3921 21.4298C19.076 21.4298 18.7636 21.3931 18.4605 21.3226L14.8774 24.9058C14.6203 25.1629 14.2716 25.3074 13.908 25.3074H1.56908C0.811911 25.3074 0.198077 24.6935 0.198059 23.9364V19.8234C0.198059 19.4598 0.342575 19.1111 0.599676 18.854L8.29581 11.1577C8.22535 10.8547 8.18873 10.5424 8.18873 10.2264C8.18873 9.14976 8.61088 8.11606 9.36449 7.34722L9.3741 7.33752L15.6807 1.03095ZM2.9401 20.3912V22.5653H13.3402L16.0822 19.8233L9.79503 13.5361L2.9401 20.3912Z" fill="currentColor"/>
                </svg>
            </button>
            <button class="tool-btn eraser" data-tool="eraser">
                <svg width="32" height="28" viewBox="0 0 32 28" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18.8076 0.556824C19.9365 0.556824 21.0205 0.996425 21.8203 1.78046L29.6035 9.41229L29.75 9.56268C30.4584 10.3301 30.8535 11.3314 30.8535 12.3732C30.8535 13.4151 30.4584 14.4164 29.75 15.1838L29.6035 15.3342L18.5674 26.1555C17.8177 26.8907 16.8187 27.3237 15.7666 27.3752L15.5557 27.3801H10.0186C8.96045 27.3797 7.9421 26.9933 7.16016 26.299L7.00684 26.1555L1.99023 21.2365C1.1905 20.4521 0.740234 19.3869 0.740234 18.2756C0.740347 17.1644 1.19064 16.0999 1.99023 15.3156L15.7939 1.78046L15.8662 1.70917H15.8721C16.6638 0.970504 17.714 0.556903 18.8076 0.556824ZM3.76074 17.0637C3.43221 17.386 3.24816 17.822 3.24805 18.2756C3.24805 18.7293 3.43207 19.166 3.76074 19.4885L8.77734 24.4074L8.90625 24.5217C9.21865 24.7727 9.61249 24.9122 10.0215 24.9123H15.5576L15.7314 24.9035C16.077 24.8698 16.4042 24.7368 16.6719 24.5217L16.8008 24.4074L16.9385 24.2707L6.67383 14.2062L3.76074 17.0637ZM18.8076 3.02362C18.3989 3.02369 18.0057 3.16349 17.6934 3.41425L17.5645 3.5285L8.44922 12.465L18.7129 22.5295L27.835 13.5861L27.9512 13.4601C28.2068 13.1543 28.3477 12.7705 28.3477 12.3732C28.3476 11.976 28.2068 11.5921 27.9512 11.2863L27.835 11.1603L20.0518 3.5285C19.7227 3.20595 19.275 3.02362 18.8076 3.02362Z" fill="currentColor" stroke="currentColor" stroke-width="0.5"/>
                </svg>
            </button>
            <button class="tool-btn text"   data-tool="text">
                <svg width="23" height="26" viewBox="0 0 23 26" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8.92228 3.16971H4.53991L3.38371 6.27042L0.605103 6.10626L0.884828 0.452026H22.5542L22.8153 6.10626L20.0554 6.27042L18.8805 3.16971H14.5168V22.3576L17.1835 22.9778L16.8105 25.13H6.62853L6.25556 22.9778L8.92228 22.3576V3.16971Z" fill="currentColor"/>
                </svg>
            </button>
            <button class="tool-btn line"   data-tool="line">
                <svg width="24" height="23" viewBox="0 0 24 23" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2.44311 19.0356L2.54309 18.9459C3.06004 18.5242 3.82266 18.5543 4.30456 19.0362C4.78626 19.5181 4.81658 20.2808 4.39488 20.7977L4.30456 20.8971L2.60841 22.5932C2.09448 23.1069 1.26147 23.1069 0.747535 22.5932C0.233618 22.0793 0.233202 21.2458 0.746967 20.7318L2.44311 19.0356ZM9.226 12.2528L9.32598 12.163C9.84293 11.7412 10.6055 11.7714 11.0874 12.2533C11.5692 12.7353 11.5995 13.4979 11.1778 14.0148L11.0874 14.1142L7.69572 17.5059C7.18179 18.0197 6.34881 18.0197 5.83484 17.5059C5.3209 16.992 5.32042 16.1585 5.83427 15.6445L9.226 12.2528ZM16.0089 5.46987L16.1089 5.38012C16.6258 4.95827 17.3884 4.98849 17.8703 5.47044C18.3521 5.95242 18.3825 6.71503 17.9607 7.23191L17.8703 7.33132L14.4786 10.723C13.9647 11.2368 13.1317 11.2367 12.6177 10.723C12.1038 10.2091 12.1034 9.37561 12.6172 8.8616L16.0089 5.46987ZM21.0962 0.382564L21.1962 0.292815C21.7131 -0.128957 22.4757 -0.0987858 22.9576 0.383132C23.4394 0.865078 23.4697 1.62773 23.048 2.1446L22.9576 2.24401L21.2615 3.94016C20.7476 4.45379 19.9145 4.45383 19.4006 3.94016C18.8867 3.42626 18.8863 2.59273 19.4 2.07871L21.0962 0.382564Z" fill="currentColor"/>
                </svg>
            </button>
            <button class="tool-btn rectangle" data-tool="rectangle">
                <svg width="25" height="25" viewBox="0 0 25 25" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.673096 20.3031C0.673096 19.5503 1.28341 18.94 2.03626 18.94C2.78912 18.94 3.39943 19.5503 3.39943 20.3031V21.5811H4.6774C5.43025 21.5811 6.04056 22.1914 6.04056 22.9443C6.04056 23.6971 5.43025 24.3074 4.6774 24.3074H2.03626C1.28341 24.3074 0.673096 23.6971 0.673096 22.9443V20.3031ZM15.2419 21.5811C15.9948 21.5811 16.6051 22.1914 16.6051 22.9443C16.6051 23.6971 15.9948 24.3074 15.2419 24.3074H9.95967C9.20681 24.3074 8.5965 23.6971 8.5965 22.9443C8.5965 22.1914 9.20681 21.5811 9.95967 21.5811H15.2419ZM21.8022 20.3031C21.8022 19.5503 22.4125 18.94 23.1653 18.94C23.9182 18.94 24.5285 19.5503 24.5285 20.3031V22.9443C24.5285 23.6971 23.9182 24.3074 23.1653 24.3074H20.5242C19.7713 24.3074 19.161 23.6971 19.161 22.9443C19.161 22.1914 19.7713 21.5811 20.5242 21.5811H21.8022V20.3031ZM0.673096 15.0209V9.7386C0.673096 8.98574 1.28341 8.37543 2.03626 8.37543C2.78912 8.37543 3.39943 8.98574 3.39943 9.7386V15.0209C3.39943 15.7737 2.78912 16.384 2.03626 16.384C1.28341 16.384 0.673096 15.7737 0.673096 15.0209ZM21.8022 15.0209V9.7386C21.8022 8.98574 22.4125 8.37543 23.1653 8.37543C23.9182 8.37543 24.5285 8.98574 24.5285 9.7386V15.0209C24.5285 15.7737 23.9182 16.384 23.1653 16.384C22.4125 16.384 21.8022 15.7737 21.8022 15.0209ZM0.673096 4.45633V1.81519L0.680417 1.67608C0.750118 0.988584 1.33038 0.452026 2.03626 0.452026H4.6774C5.43025 0.452026 6.04056 1.06234 6.04056 1.81519C6.04056 2.56805 5.43025 3.17836 4.6774 3.17836H3.39943V4.45633C3.39943 5.20918 2.78912 5.81949 2.03626 5.81949C1.28341 5.81949 0.673096 5.20918 0.673096 4.45633ZM21.8022 4.45633V3.17836H20.5242C19.7713 3.17836 19.161 2.56805 19.161 1.81519C19.161 1.06234 19.7713 0.452026 20.5242 0.452026H23.1653L23.3045 0.459348C23.9919 0.529048 24.5285 1.10931 24.5285 1.81519V4.45633C24.5285 5.20918 23.9182 5.81949 23.1653 5.81949C22.4125 5.81949 21.8022 5.20918 21.8022 4.45633ZM15.2419 0.452026C15.9948 0.452026 16.6051 1.06234 16.6051 1.81519C16.6051 2.56805 15.9948 3.17836 15.2419 3.17836H9.95967C9.20681 3.17836 8.5965 2.56805 8.5965 1.81519C8.5965 1.06234 9.20681 0.452026 9.95967 0.452026H15.2419Z" fill="currentColor"/>
                </svg>
            </button>
            <button class="tool-btn circle" data-tool="circle">
                <svg width="28" height="28" viewBox="0 0 28 28" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.9792 24.4405C16.6432 24.3779 17.2599 24.827 17.3923 25.4953C17.5333 26.2083 17.0698 26.9013 16.3568 27.0425L16.0419 27.1003C15.304 27.2278 14.5459 27.2939 13.7733 27.2939C13.0008 27.2939 12.2427 27.2278 11.5048 27.1003L11.1898 27.0425L11.0597 27.0095C10.4215 26.8147 10.0221 26.1639 10.1544 25.4953C10.2867 24.827 10.9034 24.3779 11.5674 24.4405L11.7008 24.4598L11.953 24.5064C12.5436 24.6084 13.1517 24.6622 13.7733 24.6622C14.4837 24.6622 15.1767 24.5922 15.8459 24.4598L15.9792 24.4405ZM3.1221 19.5836C3.72602 19.1793 4.54359 19.3414 4.94805 19.9451C5.72316 21.1029 6.72079 22.1005 7.87856 22.8756C8.48233 23.2801 8.64437 24.0977 8.24006 24.7016C7.83571 25.3054 7.01806 25.4672 6.41411 25.0631C4.97041 24.0966 3.72714 22.8533 2.76061 21.4096C2.35651 20.8056 2.51828 19.988 3.1221 19.5836ZM22.5986 19.9451C23.0031 19.3414 23.8206 19.1793 24.4246 19.5836C25.0284 19.988 25.1901 20.8056 24.786 21.4096C23.8195 22.8533 22.5762 24.0966 21.1325 25.0631C20.5286 25.4672 19.7109 25.3054 19.3066 24.7016C18.9023 24.0977 19.0643 23.2801 19.6681 22.8756C20.8259 22.1005 21.8235 21.1029 22.5986 19.9451ZM0.814161 11.3367C1.00895 10.6986 1.65979 10.2991 2.32842 10.4314C3.04125 10.5726 3.50484 11.2649 3.3639 11.9778L3.31731 12.23C3.21529 12.8207 3.16146 13.4288 3.16146 14.0504C3.16146 14.6719 3.21529 15.28 3.31731 15.8707L3.3639 16.1229L3.38318 16.2563C3.44576 16.9203 2.99669 17.5369 2.32842 17.6693C1.65979 17.8016 1.00895 17.4022 0.814161 16.764L0.781224 16.6338L0.723385 16.3189C0.595913 15.581 0.529785 14.8229 0.529785 14.0504C0.529785 13.1676 0.61573 12.3034 0.781224 11.4669L0.814161 11.3367ZM25.2182 10.4314C25.8869 10.2991 26.5377 10.6986 26.7325 11.3367L26.7654 11.4669L26.8233 11.7818C26.9507 12.5197 27.0169 13.2778 27.0169 14.0504C27.0169 14.9332 26.9309 15.7973 26.7654 16.6338L26.7325 16.764C26.5377 17.4022 25.8869 17.8016 25.2182 17.6693C24.5054 17.5281 24.0418 16.8358 24.1828 16.1229L24.2293 15.8707C24.3314 15.28 24.3852 14.6719 24.3852 14.0504C24.3852 13.4288 24.3314 12.8207 24.2293 12.23L24.1828 11.9778L24.1635 11.8444C24.1009 11.1805 24.55 10.5638 25.2182 10.4314ZM6.41411 3.03764C7.01806 2.63355 7.83571 2.79532 8.24006 3.39914C8.64437 4.00306 8.48233 4.82063 7.87856 5.22509C6.72079 6.0002 5.72316 6.99783 4.94805 8.1556C4.54359 8.75937 3.72602 8.92141 3.1221 8.51709C2.51828 8.11275 2.35651 7.2951 2.76061 6.69115C3.72714 5.24745 4.97041 4.00417 6.41411 3.03764ZM19.3066 3.39914C19.7109 2.79532 20.5286 2.63355 21.1325 3.03764C22.5762 4.00417 23.8195 5.24745 24.786 6.69115C25.1901 7.2951 25.0284 8.11275 24.4246 8.51709C23.8206 8.92141 23.0031 8.75937 22.5986 8.1556C21.8235 6.99783 20.8259 6.0002 19.6681 5.22509C19.0643 4.82063 18.9023 4.00306 19.3066 3.39914ZM13.7733 0.806824C14.5459 0.806824 15.304 0.872952 16.0419 1.00042L16.3568 1.05826L16.4869 1.0912C17.1251 1.28599 17.5246 1.93683 17.3923 2.60546C17.2599 3.27373 16.6432 3.7228 15.9792 3.66022L15.8459 3.64094L15.5937 3.59435C15.003 3.49233 14.3949 3.4385 13.7733 3.4385C13.0629 3.4385 12.37 3.50855 11.7008 3.64094L11.5674 3.66022C10.9034 3.7228 10.2867 3.27373 10.1544 2.60546C10.0133 1.89243 10.4769 1.1994 11.1898 1.05826L11.5048 1.00042C12.2427 0.872952 13.0008 0.806824 13.7733 0.806824Z" fill="currentColor"/>
                </svg>
            </button>

            <button class="color-picker">
                <input id="colorPicker" type="color">
            </button>
        </div>

        <!-- bottom bar: only slider -->
        <div class="slider-bar">
            <input
                    class="size-slider"
                    type="range"
                    id="toolbarSize"
                    min="1"
                    max="20"
                    value="2"
                    style="--pct:10%"
            >
        </div>
    </div>

    <!-- stomp / sockjs -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <!-- your existing logic (unchanged) -->
    <script src="whiteboard.js"></script>
</body>
</html>
